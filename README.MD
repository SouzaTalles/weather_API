## ‚òÄÔ∏è Weather API Wrapper Service

![Java](https://img.shields.io/badge/Java-17+-blue)
![Spring Boot](https://img.shields.io/badge/Spring_Boot-3.x-brightgreen)
![Redis](https://img.shields.io/badge/Redis-Cache-red)
![Maven](https://img.shields.io/badge/Build-Maven-orange)

Um servi√ßo wrapper em **Spring Boot** para consultar dados de clima de uma API externa, utilizando **Redis** para caching eficiente dos resultados.

### üåü Vis√£o Geral

Este projeto √© uma API RESTful simples que serve como intermedi√°ria (wrapper) para uma API de previs√£o do tempo externa. Ele √© constru√≠do em Java com Spring Boot e implementa caching usando Spring Cache Abstraction com **Redis** como o provedor de cache. Isso melhora a performance e reduz o n√∫mero de chamadas repetidas √† API externa.

### üöÄ Tecnologias Utilizadas

* **Java 17+**
* **Spring Boot**
* **Spring Web**
* **Spring Data Redis**
* **Redis** (como Cache Provider)
* **Maven**
* **Docker** (para o Redis)
* **Jackson** (para processamento JSON)
* **Lombok** (para a `Weather` class)

### üõ†Ô∏è Configura√ß√£o e Pr√©-requisitos

Para rodar este projeto, voc√™ precisar√° dos seguintes pr√©-requisitos:

1.  **JDK (Java Development Kit)**: Vers√£o 17 ou superior.
2.  **Maven**: Para gerenciar as depend√™ncias.
3.  **Docker**: Para rodar o container do Redis.
4.  **Chave de API**: Uma chave v√°lida para a API de previs√£o do tempo (necess√°ria para a propriedade `${API_KEY}`).

#### 1. Configurando o Redis com Docker

O Redis √© usado para armazenar os dados de cache. Execute o seguinte comando para iniciar um container Docker do Redis na porta padr√£o (`6379`):

```bash
docker run --name my-redis -p 6379:6379 -d redis
```

üí° **Nota:** Se voc√™ parar o container, o cache ser√° perdido. Voc√™ pode inici√°-lo novamente usando docker start my-redis.

---

### 2. Configurando a Chave de API

O projeto utiliza a API Visual Crossing (https://www.visualcrossing.com/weather-api/) para obter os dados de clima. A chave de API (API_KEY) e a URL base (app.api.url) s√£o lidas do ambiente ou do application.properties.

Para definir a chave de API como vari√°vel de ambiente (exemplo para PowerShell no Windows):

```powershell
$env:API_KEY = "SUA CHAVE"
```

Substitua "SUA CHAVE" pela sua chave de API real. O WeatherController.java injeta essa chave usando @Value("${API_KEY}").

## üèÉ Como Executar o Projeto

1. Clone o reposit√≥rio:
```bash
git clone <URL do seu reposit√≥rio>
```

2. Entrar na pasta do projeto:
```bash
cd weather_API
```

3. Verifique se o Redis est√° rodando (conforme a se√ß√£o anterior).

4. Execute a aplica√ß√£o Spring Boot usando o Maven Wrapper:
* Linux / MacOS:
```bash
./mvnw spring-boot:run
```
* Windows:
```bash
.\mvnw spring-boot:run
```

**A aplica√ß√£o estar√° dispon√≠vel em http://localhost:8080.**

## üíª Endpoint

O servi√ßo exp√µe um √∫nico endpoint GET para buscar a previs√£o do tempo:

| M√©todo | Endpoint | Descri√ß√£o |
| :--- | :--- | :--- |
| **GET** | `/weather/{pa√≠s_ou_cidade}` | Retorna a previs√£o do tempo atual, m√°xima e m√≠nima para o local especificado. |

* **Exemplo de Uso (pesquisa):**

```aiignore
http://localhost:8080/weather/{cidade ou pais}
```

* **Exemplo de Retorno (JSON):**
```Json
{
    "dateTime": "2023-10-27",
    "description": "Clear skies throughout the day.",
    "address": "sao paulo",
    "temperature": 25.0,
    "tempmax": 28.0,
    "tempmin": 19.0
}
```

## üß† Detalhes da Implementa√ß√£o (Caching com Redis)

O uso estrat√©gico do Redis √© o ponto chave deste projeto para garantir performance e efici√™ncia no consumo da API externa.

### 1. Habilita√ß√£o do Cache

* O cache √© habilitado globalmente pela anota√ß√£o `@EnableCaching` na classe principal `WeatherApiApplication.java`.

### 2. Configura√ß√£o do Redis

A classe `RedisConfig.java` define a pol√≠tica de armazenamento de cache:

* **TTL (Time-To-Live):** O cache de cada entrada expira ap√≥s **12 horas** (`.entryTtl(Duration.ofHours(12))`).
* **N√£o Armazenar Nulos:** `.disableCachingNullValues()` impede que requisi√ß√µes que resultam em `null` sejam cacheadas.
* **Serializa√ß√£o:** O uso de `GenericJackson2JsonRedisSerializer` assegura que o objeto Java (`Weather`) seja convertido corretamente para JSON no Redis e vice-versa, enquanto a classe `Weather` implementa `Serializable`.

### 3. Implementa√ß√£o do `@Cacheable`

A anota√ß√£o `@Cacheable` √© aplicada ao m√©todo de consulta no `WeatherController.java`:

```java
@Cacheable(value = "weather_single", key = "#country")
public Weather weather(@PathVariable String country) throws JsonProcessingException {
    // ... corpo do m√©todo (requisi√ß√£o √† API externa)
}
```
**Mecanismo:** Na primeira requisi√ß√£o para um dado pa√≠s/cidade (#country), o corpo do m√©todo √© executado (chamada √† API externa). Nas requisi√ß√µes subsequentes (Cache Hit) com a mesma chave, o resultado √© servido diretamente do Redis, ignorando a chamada externa e o servi√ßo de clima.





